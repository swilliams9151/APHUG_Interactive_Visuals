<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APHG Topic 6.6: Density and Land Use</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Building Transitions */
        .bldg { transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); transform-origin: bottom; }
        .hidden-bldg { transform: scaleY(0); opacity: 0; }
        
        /* Meter Animation */
        .meter-bar { transition: width 0.8s ease-out, background-color 0.3s; }

        /* Infill Animation */
        .infill-anim { animation: popUp 0.4s ease-out forwards; }
        @keyframes popUp { from { transform: scale(0); } to { transform: scale(1); } }
        
        /* Button Active State */
        .density-btn.active {
            background-color: #f0fdf4;
            border-color: #16a34a;
            color: #166534;
            ring: 2px solid #16a34a;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-emerald-900 text-white p-6 shadow-lg shrink-0 z-10">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold">Topic 6.6: Density and Land Use</h1>
                <p class="text-emerald-200 text-sm mt-1">Residential Patterns, Cycles of Development, and Infilling (IMP-6.A)</p>
            </div>
            <div class="hidden md:block text-xs bg-emerald-800 px-3 py-1 rounded border border-emerald-700">
                Built Landscape Analysis
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-6xl mx-auto w-full p-6 space-y-10">

        <!-- SECTION 1: DENSITY SCANNER (Visualizing Patterns) -->
        <section class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="p-6 border-b border-slate-100 bg-emerald-50 flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h2 class="text-xl font-bold text-emerald-900">1. The Density Scanner</h2>
                    <p class="text-sm text-slate-600 mt-1">Compare the characteristics of different residential zones.</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="setDensity('low')" id="btn-low" class="density-btn w-24 text-center py-2 rounded-lg border border-slate-200 text-slate-600 text-xs font-bold hover:bg-slate-50 transition">Low</button>
                    <button onclick="setDensity('med')" id="btn-med" class="density-btn w-24 text-center py-2 rounded-lg border border-slate-200 text-slate-600 text-xs font-bold hover:bg-slate-50 transition">Medium</button>
                    <button onclick="setDensity('high')" id="btn-high" class="density-btn w-24 text-center py-2 rounded-lg border border-slate-200 text-slate-600 text-xs font-bold hover:bg-slate-50 transition">High</button>
                </div>
            </div>

            <div class="grid md:grid-cols-2 h-[450px]">
                
                <!-- Visualizer -->
                <div class="relative bg-sky-100 overflow-hidden border-r border-slate-200">
                    <svg id="density-svg" viewBox="0 0 400 300" class="w-full h-full">
                        <!-- Ground -->
                        <rect y="250" width="400" height="50" fill="#475569" /> <!-- Road/Pavement -->
                        <line x1="0" y1="275" x2="400" y2="275" stroke="#94a3b8" stroke-width="2" stroke-dasharray="10,10" />

                        <!-- Sky Elements -->
                        <circle cx="350" cy="50" r="30" fill="#fcd34d" opacity="0.8" />

                        <!-- Low Density Elements (Houses) -->
                        <g id="group-low" class="bldg">
                            <rect x="20" y="200" width="60" height="50" fill="#fca5a5" stroke="#7f1d1d" stroke-width="2" />
                            <path d="M 10 200 L 50 160 L 90 200 Z" fill="#ef4444" stroke="#7f1d1d" stroke-width="2" />
                            <rect x="150" y="200" width="60" height="50" fill="#fca5a5" stroke="#7f1d1d" stroke-width="2" />
                            <path d="M 140 200 L 180 160 L 220 200 Z" fill="#ef4444" stroke="#7f1d1d" stroke-width="2" />
                            <rect x="280" y="200" width="60" height="50" fill="#fca5a5" stroke="#7f1d1d" stroke-width="2" />
                            <path d="M 270 200 L 310 160 L 350 200 Z" fill="#ef4444" stroke="#7f1d1d" stroke-width="2" />
                            <!-- Trees/Yards -->
                            <circle cx="110" cy="240" r="15" fill="#22c55e" />
                            <circle cx="240" cy="240" r="15" fill="#22c55e" />
                        </g>

                        <!-- Med Density Elements (Townhomes) -->
                        <g id="group-med" class="bldg hidden-bldg">
                            <rect x="20" y="150" width="50" height="100" fill="#fdba74" stroke="#7c2d12" stroke-width="2" />
                            <rect x="70" y="150" width="50" height="100" fill="#fed7aa" stroke="#7c2d12" stroke-width="2" />
                            <rect x="120" y="150" width="50" height="100" fill="#fdba74" stroke="#7c2d12" stroke-width="2" />
                            <rect x="170" y="150" width="50" height="100" fill="#fed7aa" stroke="#7c2d12" stroke-width="2" />
                            <rect x="220" y="150" width="50" height="100" fill="#fdba74" stroke="#7c2d12" stroke-width="2" />
                            <rect x="270" y="150" width="50" height="100" fill="#fed7aa" stroke="#7c2d12" stroke-width="2" />
                            <rect x="320" y="150" width="50" height="100" fill="#fdba74" stroke="#7c2d12" stroke-width="2" />
                        </g>

                        <!-- High Density Elements (Skyscrapers) -->
                        <g id="group-high" class="bldg hidden-bldg">
                            <rect x="40" y="50" width="80" height="200" fill="#cbd5e1" stroke="#334155" stroke-width="2" />
                            <rect x="160" y="20" width="80" height="230" fill="#94a3b8" stroke="#334155" stroke-width="2" />
                            <rect x="280" y="80" width="80" height="170" fill="#cbd5e1" stroke="#334155" stroke-width="2" />
                            <!-- Windows -->
                            <rect x="50" y="60" width="60" height="10" fill="#bfdbfe" />
                            <rect x="50" y="80" width="60" height="10" fill="#bfdbfe" />
                            <rect x="50" y="100" width="60" height="10" fill="#bfdbfe" />
                            <rect x="170" y="40" width="60" height="10" fill="#bfdbfe" />
                        </g>
                    </svg>
                </div>

                <!-- Data Dashboard -->
                <div class="p-8 bg-white flex flex-col justify-center space-y-6">
                    <h3 id="density-title" class="text-2xl font-extrabold text-slate-800">Select a Density</h3>
                    
                    <!-- Stat 1 -->
                    <div>
                        <div class="flex justify-between text-xs font-bold text-slate-500 uppercase mb-1">
                            <span>Population Density</span>
                            <span id="val-pop" class="text-emerald-600">--</span>
                        </div>
                        <div class="w-full h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div id="bar-pop" class="h-full bg-emerald-500 meter-bar" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Stat 2 -->
                    <div>
                        <div class="flex justify-between text-xs font-bold text-slate-500 uppercase mb-1">
                            <span>Infrastructure Cost (Per Person)</span>
                            <span id="val-cost" class="text-blue-600">--</span>
                        </div>
                        <div class="w-full h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div id="bar-cost" class="h-full bg-blue-500 meter-bar" style="width: 0%"></div>
                        </div>
                        <p class="text-[10px] text-slate-400 mt-1">High density shares costs (pipes/roads) among more people.</p>
                    </div>

                    <!-- Stat 3 -->
                    <div>
                        <div class="flex justify-between text-xs font-bold text-slate-500 uppercase mb-1">
                            <span>Land Value (Bid-Rent)</span>
                            <span id="val-land" class="text-purple-600">--</span>
                        </div>
                        <div class="w-full h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div id="bar-land" class="h-full bg-purple-500 meter-bar" style="width: 0%"></div>
                        </div>
                    </div>

                    <div id="desc-box" class="bg-slate-50 p-3 rounded border-l-4 border-emerald-500 text-xs text-slate-600 italic">
                        Select a button to see the stats.
                    </div>
                </div>

            </div>
        </section>

        <!-- SECTION 2: INFILLING SIMULATOR (IMP-6.A.1) -->
        <section class="grid lg:grid-cols-3 gap-8">
            
            <!-- Explanation -->
            <div class="bg-slate-800 p-6 rounded-xl shadow-lg border border-slate-700">
                <h2 class="text-xl font-bold text-white mb-4">2. Infilling (Smart Growth)</h2>
                <p class="text-sm text-slate-300 leading-relaxed mb-4">
                    <strong>Infilling</strong> is the process of building on vacant or underused land within an existing urban area.
                </p>
                <ul class="text-xs text-slate-400 space-y-2 list-disc pl-4 mb-6">
                    <li>Increases density without Sprawl.</li>
                    <li>Uses existing infrastructure (no new roads needed).</li>
                    <li>Often involves "Brownfields" (old factories).</li>
                </ul>
                <div class="bg-slate-700 p-4 rounded-lg text-center">
                    <div class="text-xs uppercase font-bold text-slate-400 mb-1">Current Population</div>
                    <div id="infill-pop" class="text-3xl font-mono font-bold text-emerald-400">50</div>
                </div>
            </div>

            <!-- Interactive Grid -->
            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-slate-800">Urban Neighborhood Map</h3>
                    <span class="text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded">Click Grey Lots to Infill</span>
                </div>

                <div class="grid grid-cols-5 gap-2 h-64">
                    <!-- Row 1 -->
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div onclick="infill(this)" class="bg-slate-300 rounded flex items-center justify-center text-sm text-slate-500 font-bold cursor-pointer hover:bg-slate-400 transition">Vacant</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>

                    <!-- Row 2 -->
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div onclick="infill(this)" class="bg-slate-300 rounded flex items-center justify-center text-sm text-slate-500 font-bold cursor-pointer hover:bg-slate-400 transition">Parking</div>
                    <div class="bg-blue-200 rounded flex items-center justify-center text-2xl">üè´</div>
                    <div onclick="infill(this)" class="bg-slate-300 rounded flex items-center justify-center text-sm text-slate-500 font-bold cursor-pointer hover:bg-slate-400 transition">Empty</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>

                    <!-- Row 3 -->
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div class="bg-emerald-200 rounded flex items-center justify-center text-2xl">üè†</div>
                    <div onclick="infill(this)" class="bg-slate-300 rounded flex items-center justify-center text-sm text-slate-500 font-bold cursor-pointer hover:bg-slate-400 transition">Brownfield</div>
                </div>
            </div>

        </section>

    </main>

    <script>
        // --- 1. DENSITY SCANNER LOGIC ---
        const data = {
            'low': {
                title: "Low Density (Suburban)",
                pop: "Low (~2,000/sq mi)",
                popVal: 20,
                cost: "High ($$$)",
                costVal: 90,
                land: "Low ($)",
                landVal: 20,
                desc: "Single-family homes with large yards. Highly car-dependent. Expensive to provide utilities per person because houses are far apart."
            },
            'med': {
                title: "Medium Density",
                pop: "Medium (~10,000/sq mi)",
                popVal: 50,
                cost: "Medium ($$)",
                costVal: 50,
                land: "Medium ($$)",
                landVal: 50,
                desc: "Row houses, duplexes, or small yards. Walkable neighborhoods. A balance between space and efficiency."
            },
            'high': {
                title: "High Density (Urban)",
                pop: "High (~50,000+/sq mi)",
                popVal: 95,
                cost: "Low ($)",
                costVal: 20,
                land: "High ($$$)",
                landVal: 95,
                desc: "Multi-story apartments/condos. Relies on public transit. Most efficient for infrastructure (short pipes/wires per person), but land is expensive."
            }
        };

        function setDensity(type) {
            // UI Buttons
            document.querySelectorAll('.density-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${type}`).classList.add('active');

            // Visuals
            ['low', 'med', 'high'].forEach(t => {
                const el = document.getElementById(`group-${t}`);
                if (t === type) el.classList.remove('hidden-bldg');
                else el.classList.add('hidden-bldg');
            });

            // Data Update
            const info = data[type];
            document.getElementById('density-title').innerText = info.title;
            document.getElementById('desc-box').innerText = info.desc;

            updateMeter('pop', info.popVal, info.pop);
            updateMeter('cost', info.costVal, info.cost);
            updateMeter('land', info.landVal, info.land);
        }

        function updateMeter(id, width, text) {
            document.getElementById(`bar-${id}`).style.width = `${width}%`;
            document.getElementById(`val-${id}`).innerText = text;
        }

        // --- 2. INFILL LOGIC ---
        let population = 50;

        function infill(el) {
            // Change style
            el.className = "bg-purple-200 rounded flex items-center justify-center text-2xl infill-anim shadow-inner border border-purple-300";
            el.innerText = "üè¢"; // Mixed Use / Apartment
            el.onclick = null; // Disable click

            // Update Score
            population += 20; // High density boost
            const counter = document.getElementById('infill-pop');
            counter.innerText = population;
            counter.classList.add('scale-110', 'text-purple-400');
            setTimeout(() => counter.classList.remove('scale-110', 'text-purple-400'), 200);
        }

        // Init
        setDensity('low');

    </script>
</body>
</html>
