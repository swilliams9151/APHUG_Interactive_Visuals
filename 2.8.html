<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APHG Topic 2.8: Women and Demographic Change</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Smooth transitions */
        .family-icon { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .hidden-child { opacity: 0; transform: scale(0); width: 0 !important; margin: 0 !important; }
        
        /* Range Slider */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%;
            background: #db2777; cursor: pointer; margin-top: -10px; box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #e5e7eb; border-radius: 2px;
        }

        /* Map Animation */
        .migrant-dot { transition: cx 2s ease-in-out, cy 2s ease-in-out, opacity 0.5s; }
        .migrant-line { stroke-dasharray: 5; animation: dash 30s linear infinite; }
        @keyframes dash { to { stroke-dashoffset: -100; } }
    </style>
</head>
<body class="bg-pink-50 text-slate-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-pink-900 text-white p-6 shadow-lg shrink-0">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold">Topic 2.8: Women & Demographics</h1>
                <p class="text-pink-200 text-sm mt-1">Education, Employment, and Ravenstein's Laws (SPS-2.B)</p>
            </div>
            <div class="hidden md:block text-xs bg-pink-800 px-3 py-1 rounded border border-pink-700">
                Empowerment = Lower TFR
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-6xl mx-auto w-full p-6 space-y-10">

        <!-- SECTION 1: THE FERTILITY LINK (SPS-2.B.1) -->
        <section class="bg-white rounded-2xl shadow-xl border border-pink-100 overflow-hidden">
            <div class="p-6 border-b border-pink-50 bg-pink-50/50 flex justify-between items-center">
                <div>
                    <h2 class="text-xl font-bold text-pink-900">1. The Empowerment Effect</h2>
                    <p class="text-sm text-slate-600 mt-1">How education and health care drastically reduce fertility rates (TFR).</p>
                </div>
                <div class="bg-white px-4 py-2 rounded-lg shadow-sm border border-pink-100">
                    <span class="block text-[10px] text-slate-400 uppercase font-bold">Calculated TFR</span>
                    <span id="tfr-display" class="text-3xl font-extrabold text-pink-600">6.5</span>
                </div>
            </div>

            <div class="grid md:grid-cols-2">
                
                <!-- Controls -->
                <div class="p-8 space-y-8 border-r border-pink-50">
                    
                    <!-- Education Slider -->
                    <div>
                        <div class="flex justify-between mb-2">
                            <label class="text-sm font-bold text-slate-700">Female Literacy Rate</label>
                            <span id="val-lit" class="text-sm font-mono text-pink-600 font-bold">10%</span>
                        </div>
                        <input type="range" id="slider-lit" min="0" max="100" value="10" oninput="updateFertility()">
                        <p class="text-xs text-slate-500 mt-2">
                            <strong>Why it matters:</strong> Education delays marriage age and increases career opportunities ("Opportunity Cost" of children).
                        </p>
                    </div>

                    <!-- Contraception Slider -->
                    <div>
                        <div class="flex justify-between mb-2">
                            <label class="text-sm font-bold text-slate-700">Access to Contraception</label>
                            <span id="val-contra" class="text-sm font-mono text-pink-600 font-bold">5%</span>
                        </div>
                        <input type="range" id="slider-contra" min="0" max="100" value="5" oninput="updateFertility()">
                        <p class="text-xs text-slate-500 mt-2">
                            <strong>Why it matters:</strong> Allows women to control birth spacing and family size.
                        </p>
                    </div>

                    <!-- Presets -->
                    <div class="pt-4 border-t border-slate-100">
                        <span class="text-[10px] font-bold text-slate-400 uppercase">Load Real Data:</span>
                        <div class="flex gap-2 mt-2">
                            <button onclick="setPreset('niger')" class="px-3 py-1 text-xs bg-slate-100 hover:bg-pink-100 rounded border border-slate-200 transition font-bold">üá≥üá™ Niger</button>
                            <button onclick="setPreset('india')" class="px-3 py-1 text-xs bg-slate-100 hover:bg-pink-100 rounded border border-slate-200 transition font-bold">üáÆüá≥ India</button>
                            <button onclick="setPreset('skorea')" class="px-3 py-1 text-xs bg-slate-100 hover:bg-pink-100 rounded border border-slate-200 transition font-bold">üá∞üá∑ S. Korea</button>
                        </div>
                    </div>

                </div>

                <!-- Visualization: Family Portrait -->
                <div class="bg-slate-50 p-8 flex flex-col items-center justify-center relative overflow-hidden">
                    <h3 class="text-xs font-bold text-slate-400 uppercase mb-6 tracking-wider">Typical Family Size</h3>
                    
                    <div class="flex items-end justify-center gap-2 h-32">
                        <!-- Parents -->
                        <div class="flex flex-col items-center">
                            <div class="text-6xl">üë©</div>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="text-6xl">üë®</div>
                        </div>
                        
                        <!-- Children Container -->
                        <div id="children-container" class="flex items-end gap-1 ml-4">
                            <!-- Kids generated by JS -->
                        </div>
                    </div>

                    <div id="outcome-text" class="mt-8 text-center bg-white p-4 rounded-lg shadow-sm border border-pink-100 max-w-xs">
                        <h4 class="font-bold text-pink-800 text-sm mb-1">Stage 2 Demographic</h4>
                        <p class="text-xs text-slate-600 leading-relaxed">With low education, women marry young. Children are seen as economic assets for farm labor.</p>
                    </div>
                </div>

            </div>
        </section>

        <!-- SECTION 2: RAVENSTEIN'S GENDER LAWS (SPS-2.B.2) -->
        <div class="grid md:grid-cols-2 gap-8">
            
            <!-- The Logic -->
            <section class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-indigo-500">
                <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center">
                    <span class="text-2xl mr-2">üó∫Ô∏è</span> Ravenstein's Laws (Gender)
                </h2>
                
                <div class="space-y-4">
                    <div onclick="setMapMode('classic')" id="card-classic" class="cursor-pointer p-4 rounded-lg bg-indigo-50 border border-indigo-200 hover:bg-indigo-100 transition active ring-2 ring-indigo-500 ring-offset-2">
                        <h3 class="font-bold text-indigo-900 text-sm">Classic Law (1880s)</h3>
                        <p class="text-xs text-slate-600 mt-1">
                            "Females are more migratory than males within the country of their birth, but males more frequently go beyond."
                            <br><span class="italic text-indigo-600 mt-1 block">Women = Short Distance (Internal). Men = Long Distance (International).</span>
                        </p>
                    </div>

                    <div onclick="setMapMode('modern')" id="card-modern" class="cursor-pointer p-4 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 transition">
                        <h3 class="font-bold text-slate-800 text-sm">Modern Reality (21st Century)</h3>
                        <p class="text-xs text-slate-600 mt-1">
                            Changing roles mean women now make up ~50% of international migrants.
                            <br><span class="italic text-slate-500 mt-1 block">Driven by: Nursing, Domestic work, Refugees, and Education.</span>
                        </p>
                    </div>
                </div>
            </section>

            <!-- The Map Visualizer -->
            <section class="bg-slate-900 rounded-xl shadow-lg overflow-hidden relative h-64 md:h-auto">
                <!-- Map Background -->
                <svg viewBox="0 0 400 200" class="w-full h-full opacity-20 absolute inset-0">
                    <path d="M 50 50 L 100 150 L 150 50 Z" fill="#94a3b8" /> <!-- Abstract Country A -->
                    <path d="M 250 50 L 300 150 L 350 50 Z" fill="#94a3b8" /> <!-- Abstract Country B (Far away) -->
                </svg>

                <!-- Overlay Info -->
                <div class="absolute top-2 right-2 text-[10px] text-slate-400 font-mono bg-slate-800 px-2 py-1 rounded">
                    Visualizing Migration Flow
                </div>

                <!-- Visualization Container -->
                <svg id="migration-svg" class="absolute inset-0 w-full h-full" viewBox="0 0 400 200">
                    <!-- Injected via JS -->
                </svg>
                
                <!-- Legend -->
                <div class="absolute bottom-2 left-2 flex gap-3 text-[10px] font-bold">
                    <div class="flex items-center text-blue-400"><span class="w-2 h-2 bg-blue-500 rounded-full mr-1"></span> Male</div>
                    <div class="flex items-center text-pink-400"><span class="w-2 h-2 bg-pink-500 rounded-full mr-1"></span> Female</div>
                </div>
            </section>

        </div>

        <!-- SECTION 3: THE KERALA MODEL -->
        <section class="bg-teal-50 rounded-xl border border-teal-200 p-6 shadow-sm">
            <div class="flex flex-col md:flex-row gap-6 items-center">
                <div class="flex-1">
                    <h3 class="text-lg font-bold text-teal-900 mb-2">The "Kerala Paradox" (Case Study)</h3>
                    <p class="text-sm text-slate-700 leading-relaxed mb-3">
                        Kerala is a state in India. Despite having a relatively low GDP (it is poor), it has a literacy rate of <strong>96%</strong> (highest in India).
                    </p>
                    <div class="bg-white p-3 rounded border border-teal-100 text-xs text-slate-600">
                        <strong>Result:</strong> Because women are educated, Kerala's TFR is <strong>1.8</strong> (lower than the US!), proving that <span class="text-teal-700 font-bold">Empowerment > Wealth</span> for lowering birth rates.
                    </div>
                </div>
                <div class="w-full md:w-1/3 bg-white p-4 rounded-lg shadow text-center">
                    <div class="text-4xl mb-2">üéì</div>
                    <div class="text-2xl font-extrabold text-teal-600">96%</div>
                    <div class="text-[10px] uppercase tracking-widest text-slate-400 font-bold">Female Literacy</div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- 1. FERTILITY LOGIC ---
        const presets = {
            'niger': { lit: 15, contra: 10 }, // TFR ~6.8
            'india': { lit: 70, contra: 60 }, // TFR ~2.2
            'skorea': { lit: 99, contra: 85 } // TFR ~0.8
        };

        function updateFertility() {
            const lit = parseInt(document.getElementById('slider-lit').value);
            const contra = parseInt(document.getElementById('slider-contra').value);

            // Update Labels
            document.getElementById('val-lit').innerText = lit + "%";
            document.getElementById('val-contra').innerText = contra + "%";

            // Algorithm: 
            // Base TFR = 7.0
            // Education reduces it by up to 4.0
            // Contraception reduces it by up to 2.5
            // Min TFR = 0.5
            
            const reductionLit = (lit / 100) * 4.0;
            const reductionContra = (contra / 100) * 2.5;
            
            let tfr = 7.0 - reductionLit - reductionContra;
            if(tfr < 0.8) tfr = 0.8; // Floor
            
            tfr = tfr.toFixed(1);

            // Update Display
            document.getElementById('tfr-display').innerText = tfr;

            // Update Visuals
            updateFamily(tfr);
            updateText(tfr, lit);
        }

        function updateFamily(tfr) {
            const container = document.getElementById('children-container');
            container.innerHTML = ''; // Clear
            
            const count = Math.round(tfr);
            
            for(let i=0; i<count; i++) {
                const child = document.createElement('div');
                // Scale sizes slightly for variety
                const size = i % 3 === 0 ? 'text-3xl' : (i % 3 === 1 ? 'text-2xl' : 'text-4xl');
                child.className = `family-icon ${size} animate-bounce-slow`;
                child.style.animationDelay = `${i * 0.1}s`;
                child.innerText = i % 2 === 0 ? 'üë¶' : 'üëß';
                container.appendChild(child);
            }
        }

        function updateText(tfr, lit) {
            const box = document.getElementById('outcome-text');
            let title, text;

            if (tfr > 5) {
                title = "Stage 2 Demographic";
                text = "With low education, women marry young. Children are seen as economic assets for farm labor.";
                box.className = "mt-8 text-center bg-pink-50 p-4 rounded-lg shadow-sm border border-pink-200 max-w-xs";
            } else if (tfr > 2.1) {
                title = "Stage 3 Demographic";
                text = "As literacy rises, women enter the workforce. The 'Opportunity Cost' of raising children increases, so families shrink.";
                box.className = "mt-8 text-center bg-purple-50 p-4 rounded-lg shadow-sm border border-purple-200 max-w-xs";
            } else {
                title = "Stage 4/5 Demographic";
                text = "High empowerment. Women prioritize careers. Family planning is universal. Population growth stabilizes or declines.";
                box.className = "mt-8 text-center bg-white p-4 rounded-lg shadow-sm border border-slate-200 max-w-xs";
            }
            
            box.innerHTML = `<h4 class="font-bold text-pink-900 text-sm mb-1">${title}</h4><p class="text-xs text-slate-600 leading-relaxed">${text}</p>`;
        }

        function setPreset(key) {
            const data = presets[key];
            document.getElementById('slider-lit').value = data.lit;
            document.getElementById('slider-contra').value = data.contra;
            updateFertility();
        }

        // --- 2. RAVENSTEIN MAP LOGIC ---
        
        function setMapMode(mode) {
            const svg = document.getElementById('migration-svg');
            svg.innerHTML = ''; // Clear
            
            // Reset Cards
            document.getElementById('card-classic').className = "cursor-pointer p-4 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 transition";
            document.getElementById('card-modern').className = "cursor-pointer p-4 rounded-lg bg-white border border-slate-200 hover:bg-slate-50 transition";
            
            if (mode === 'classic') {
                document.getElementById('card-classic').className = "cursor-pointer p-4 rounded-lg bg-indigo-50 border border-indigo-200 transition ring-2 ring-indigo-500 ring-offset-2";
                
                // Classic: Men go Far, Women stay Near
                // Short arrows (Women - Pink) inside Country A
                drawArrow(svg, 100, 100, 120, 80, '#ec4899', 2);
                drawArrow(svg, 80, 120, 100, 100, '#ec4899', 2);
                
                // Long arrow (Men - Blue) from A to B
                drawArrow(svg, 100, 100, 300, 100, '#3b82f6', 4);
            } else {
                document.getElementById('card-modern').className = "cursor-pointer p-4 rounded-lg bg-indigo-50 border border-indigo-200 transition ring-2 ring-indigo-500 ring-offset-2";
                
                // Modern: Both go far
                // Men (Blue) A to B
                drawArrow(svg, 100, 90, 300, 90, '#3b82f6', 3);
                // Women (Pink) A to B
                drawArrow(svg, 100, 110, 300, 110, '#ec4899', 3);
            }
        }

        function drawArrow(svg, x1, y1, x2, y2, color, width) {
            const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", x1);
            line.setAttribute("y1", y1);
            line.setAttribute("x2", x2);
            line.setAttribute("y2", y2);
            line.setAttribute("stroke", color);
            line.setAttribute("stroke-width", width);
            line.setAttribute("marker-end", "url(#arrowhead)");
            
            // Add animation class if long distance
            if (Math.abs(x2-x1) > 50) line.setAttribute("class", "migrant-line");
            
            svg.appendChild(line);
            
            // Add marker def if not exists (simplified here by assuming browser support or adding manually)
            // Let's add a simple circle at end instead of marker for simplicity in generated code
            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            circle.setAttribute("cx", x2);
            circle.setAttribute("cy", y2);
            circle.setAttribute("r", width + 2);
            circle.setAttribute("fill", color);
            svg.appendChild(circle);
        }

        // Init
        updateFertility();
        setMapMode('classic');

    </script>
</body>
</html>
