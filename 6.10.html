<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APHG Topic 6.10: Challenges of Urban Changes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Tab Transitions */
        .tab-content { transition: opacity 0.3s ease-in-out; }
        .hidden-tab { display: none; opacity: 0; }
        .visible-tab { display: block; opacity: 1; }

        /* Redlining Map Zones */
        .zone { transition: all 0.3s ease; cursor: pointer; }
        .zone:hover { fill-opacity: 0.8; stroke: white; stroke-width: 2; }

        /* Gentrification Animation */
        .house-flip { transition: all 0.5s ease; }
        .renovated { fill: #60a5fa; stroke: #2563eb; transform: scale(1.05); }
        
        /* Tab Buttons */
        .nav-btn.active { background-color: white; color: #be123c; border-bottom: 4px solid #be123c; }
        .nav-btn { border-bottom: 4px solid transparent; }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-rose-900 text-white p-6 shadow-lg shrink-0 z-10">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold">Topic 6.10: Challenges of Urban Changes</h1>
                <p class="text-rose-200 text-sm mt-1">Redlining, Gentrification, and Disamenity Zones (SPS-6.A)</p>
            </div>
            <div class="hidden md:block text-xs bg-rose-800 px-3 py-1 rounded border border-rose-700">
                Causes & Effects
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-6xl mx-auto w-full p-6 space-y-8">

        <!-- Navigation -->
        <div class="flex border-b border-slate-700 mb-6">
            <button onclick="setTab('redlining')" id="tab-redlining" class="nav-btn active w-1/3 py-3 font-bold text-slate-400 hover:bg-slate-800 transition">
                üèöÔ∏è Housing Discrimination
            </button>
            <button onclick="setTab('gentrification')" id="tab-gentrification" class="nav-btn w-1/3 py-3 font-bold text-slate-400 hover:bg-slate-800 transition">
                üèóÔ∏è Gentrification
            </button>
            <button onclick="setTab('squatter')" id="tab-squatter" class="nav-btn w-1/3 py-3 font-bold text-slate-400 hover:bg-slate-800 transition">
                ‚õ∫ Squatter Settlements
            </button>
        </div>

        <!-- SCENARIO 1: REDLINING (SPS-6.A.1) -->
        <section id="view-redlining" class="visible-tab space-y-8">
            
            <div class="bg-white text-slate-800 rounded-2xl shadow-xl border border-slate-200 p-6">
                <div class="border-b border-slate-100 pb-4 mb-4">
                    <h2 class="text-xl font-bold text-rose-900">1. The Legacy of Redlining (1930s - Present)</h2>
                    <p class="text-sm text-slate-600 mt-1">
                        In the 1930s, the HOLC graded neighborhoods. "Red" zones were deemed "Hazardous" (often minority areas) and denied mortgages.
                    </p>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Map -->
                    <div class="flex flex-col items-center">
                        <h3 class="text-xs font-bold uppercase text-slate-400 mb-2">City Map (Click to Grade)</h3>
                        <svg viewBox="0 0 300 300" class="w-64 h-64 shadow-lg rounded-lg bg-slate-100 border border-slate-300">
                            <!-- Zone A (Green) -->
                            <rect id="zone-a" onclick="gradeZone('a')" x="20" y="20" width="120" height="120" fill="#cbd5e1" class="zone" />
                            <text x="80" y="80" text-anchor="middle" font-weight="bold" fill="#475569" pointer-events="none">Northside</text>
                            
                            <!-- Zone B (Blue) -->
                            <rect id="zone-b" onclick="gradeZone('b')" x="160" y="20" width="120" height="120" fill="#cbd5e1" class="zone" />
                            <text x="220" y="80" text-anchor="middle" font-weight="bold" fill="#475569" pointer-events="none">Eastside</text>
                            
                            <!-- Zone C (Yellow) -->
                            <rect id="zone-c" onclick="gradeZone('c')" x="20" y="160" width="120" height="120" fill="#cbd5e1" class="zone" />
                            <text x="80" y="220" text-anchor="middle" font-weight="bold" fill="#475569" pointer-events="none">Westside</text>
                            
                            <!-- Zone D (Red) -->
                            <rect id="zone-d" onclick="gradeZone('d')" x="160" y="160" width="120" height="120" fill="#cbd5e1" class="zone" />
                            <text x="220" y="220" text-anchor="middle" font-weight="bold" fill="#475569" pointer-events="none">Southside</text>
                        </svg>
                        <div class="mt-4 flex gap-2">
                            <button onclick="applyGrades()" class="bg-rose-600 hover:bg-rose-500 text-white px-4 py-2 rounded font-bold text-sm shadow">
                                Apply HOLC Grades
                            </button>
                        </div>
                    </div>

                    <!-- Wealth Chart -->
                    <div class="flex flex-col">
                        <h3 class="text-xs font-bold uppercase text-slate-400 mb-2">Home Value Growth (1930-2020)</h3>
                        <div class="flex-1 bg-slate-50 border border-slate-200 rounded-lg p-4 relative">
                            <canvas id="wealthChart"></canvas>
                        </div>
                        <p id="redlining-feedback" class="text-xs text-slate-500 mt-2 italic">
                            Click "Apply Grades" to see the long-term economic impact.
                        </p>
                    </div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-slate-800 p-5 rounded-xl border border-slate-700">
                    <h3 class="text-rose-400 font-bold text-sm mb-2">Blockbusting</h3>
                    <p class="text-xs text-slate-400 leading-relaxed">
                        Real estate agents convinced white homeowners to sell cheap by stoking fear that minorities were moving in. They then resold to minorities at inflated prices. Result: "White Flight."
                    </p>
                </div>
                <div class="bg-slate-800 p-5 rounded-xl border border-slate-700">
                    <h3 class="text-rose-400 font-bold text-sm mb-2">Environmental Injustice</h3>
                    <p class="text-xs text-slate-400 leading-relaxed">
                        Redlined zones (Disamenity Zones) were often zoned for industry. Today, these areas suffer higher rates of asthma, hotter temperatures (Heat Islands), and lack parks.
                    </p>
                </div>
            </div>

        </section>

        <!-- SCENARIO 2: GENTRIFICATION (SPS-6.A.4) -->
        <section id="view-gentrification" class="hidden-tab bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="p-6 border-b border-slate-100 bg-indigo-50">
                <h2 class="text-xl font-bold text-indigo-900">2. The Gentrification Balance</h2>
                <p class="text-sm text-slate-600 mt-1">Renovate the neighborhood. Watch the Tax Revenue rise, but watch the Displacement rise too.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 p-8">
                
                <!-- The Neighborhood -->
                <div class="bg-slate-100 p-6 rounded-xl border border-slate-300 flex flex-col items-center">
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <!-- 9 Houses -->
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                        <svg width="60" height="60" onclick="flipHouse(this)" class="house-flip cursor-pointer" viewBox="0 0 100 100">
                            <path d="M 20 40 L 50 10 L 80 40 L 80 90 L 20 90 Z" fill="#94a3b8" stroke="#475569" stroke-width="4" />
                        </svg>
                    </div>
                    <p class="text-xs text-slate-500">Click a house to renovate it.</p>
                </div>

                <!-- The Meters -->
                <div class="flex flex-col justify-center space-y-6">
                    
                    <!-- Tax Revenue -->
                    <div>
                        <div class="flex justify-between text-xs font-bold text-slate-500 uppercase mb-1">
                            <span>Tax Base (City Wealth)</span>
                            <span class="text-emerald-600 font-bold" id="tax-val">Low</span>
                        </div>
                        <div class="w-full h-4 bg-slate-100 rounded-full overflow-hidden">
                            <div id="tax-bar" class="h-full bg-emerald-500 transition-all duration-500" style="width: 10%"></div>
                        </div>
                        <p class="text-[10px] text-slate-400 mt-1">Pays for better schools, parks, and police.</p>
                    </div>

                    <!-- Displacement -->
                    <div>
                        <div class="flex justify-between text-xs font-bold text-slate-500 uppercase mb-1">
                            <span>Displacement (Rent Cost)</span>
                            <span class="text-red-600 font-bold" id="disp-val">Low</span>
                        </div>
                        <div class="w-full h-4 bg-slate-100 rounded-full overflow-hidden">
                            <div id="disp-bar" class="h-full bg-red-500 transition-all duration-500" style="width: 10%"></div>
                        </div>
                        <p class="text-[10px] text-slate-400 mt-1">Original low-income residents forced to move out.</p>
                    </div>

                    <!-- Analysis -->
                    <div id="gen-feedback" class="p-4 bg-indigo-50 rounded border border-indigo-100 text-xs text-indigo-800 italic">
                        Start renovating to see the effects.
                    </div>

                </div>
            </div>
        </section>

        <!-- SCENARIO 3: SQUATTER SETTLEMENTS (SPS-6.A.2) -->
        <section id="view-squatter" class="hidden-tab bg-slate-800 rounded-2xl shadow-xl border border-slate-700 p-8 text-white">
            <div class="flex flex-col md:flex-row gap-8">
                
                <div class="flex-1">
                    <h2 class="text-xl font-bold text-white mb-2">3. Squatter Settlements (Favelas)</h2>
                    <p class="text-sm text-slate-400 mb-4">
                        Millions in LDCs live in "Disamenity Zones" on the periphery. They lack <strong>Land Tenure</strong> (legal ownership).
                    </p>
                    <p class="text-xs text-slate-500 mb-6">
                        Scenario: A new settlement has formed on a dangerous hillside in Rio. What do you do?
                    </p>

                    <div class="space-y-3">
                        <button onclick="resolveSquatter('evict')" class="w-full text-left p-4 rounded-lg bg-slate-700 hover:bg-slate-600 border border-slate-600 transition group">
                            <div class="font-bold text-red-400">Option A: Evict & Bulldoze</div>
                            <div class="text-xs text-slate-400 group-hover:text-slate-200 mt-1">Clear the land. Enforce property laws.</div>
                        </button>

                        <button onclick="resolveSquatter('tenure')" class="w-full text-left p-4 rounded-lg bg-slate-700 hover:bg-slate-600 border border-slate-600 transition group">
                            <div class="font-bold text-emerald-400">Option B: Grant Land Tenure</div>
                            <div class="text-xs text-slate-400 group-hover:text-slate-200 mt-1">Give them legal titles and pave roads (In Situ Accretion).</div>
                        </button>
                    </div>
                </div>

                <!-- Visualizer -->
                <div class="w-full md:w-1/2 bg-slate-900 rounded-xl border-2 border-slate-600 flex flex-col items-center justify-center p-6 text-center relative overflow-hidden">
                    <div id="squatter-vis" class="text-6xl mb-4">‚õ∫‚õ∫‚õ∫</div>
                    <div id="squatter-res" class="text-sm font-bold text-white">Current Status: Illegal Settlement</div>
                    <p id="squatter-desc" class="text-xs text-slate-400 mt-2 px-4">No water, no electricity, high crime.</p>
                </div>

            </div>
        </section>

    </main>

    <script>
        // --- TAB LOGIC ---
        function setTab(id) {
            ['redlining', 'gentrification', 'squatter'].forEach(t => {
                document.getElementById(`view-${t}`).classList.add('hidden-tab');
                document.getElementById(`view-${t}`).classList.remove('visible-tab');
                document.getElementById(`tab-${t}`).classList.remove('active');
                document.getElementById(`tab-${t}`).classList.add('text-slate-400');
            });
            document.getElementById(`view-${id}`).classList.remove('hidden-tab');
            document.getElementById(`view-${id}`).classList.add('visible-tab');
            const activeBtn = document.getElementById(`tab-${id}`);
            activeBtn.classList.add('active');
            activeBtn.classList.remove('text-slate-400');
        }

        // --- 1. REDLINING LOGIC ---
        let redliningChart;

        function gradeZone(zone) {
            // Visual selection
            document.querySelectorAll('.zone').forEach(z => z.setAttribute('stroke-width', '0'));
            document.getElementById(`zone-${zone}`).setAttribute('stroke', '#ef4444');
            document.getElementById(`zone-${zone}`).setAttribute('stroke-width', '4');
        }

        function applyGrades() {
            // Color the map (HOLC style)
            document.getElementById('zone-a').setAttribute('fill', '#22c55e'); // A (Green)
            document.getElementById('zone-b').setAttribute('fill', '#3b82f6'); // B (Blue)
            document.getElementById('zone-c').setAttribute('fill', '#eab308'); // C (Yellow)
            document.getElementById('zone-d').setAttribute('fill', '#ef4444'); // D (Red)

            document.getElementById('redlining-feedback').innerHTML = "Notice the <strong>Wealth Gap</strong>. Zone A homes accrued value (Equity). Zone D homes stagnated because buyers couldn't get loans.";
            document.getElementById('redlining-feedback').className = "text-xs text-rose-700 font-bold mt-2 bg-rose-50 p-2 rounded border border-rose-200";

            // Render Chart
            const ctx = document.getElementById('wealthChart').getContext('2d');
            if (redliningChart) redliningChart.destroy();

            redliningChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1930', '1950', '1970', '1990', '2010', '2024'],
                    datasets: [{
                        label: 'Zone A (Green)',
                        data: [5000, 12000, 45000, 150000, 400000, 850000],
                        borderColor: '#22c55e',
                        tension: 0.4
                    }, {
                        label: 'Zone D (Red)',
                        data: [5000, 5500, 6000, 25000, 60000, 120000],
                        borderColor: '#ef4444',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } }
                }
            });
        }

        // --- 2. GENTRIFICATION LOGIC ---
        let renovatedCount = 0;

        function flipHouse(el) {
            const path = el.querySelector('path');
            
            if (path.classList.contains('renovated')) return; // Already flipped

            path.classList.add('renovated');
            renovatedCount++;
            updateGenMeters();
        }

        function updateGenMeters() {
            const pct = (renovatedCount / 9) * 100;
            
            // Update Bars
            document.getElementById('tax-bar').style.width = `${Math.max(10, pct)}%`;
            document.getElementById('disp-bar').style.width = `${Math.max(10, pct)}%`;

            // Text Logic
            const taxVal = document.getElementById('tax-val');
            const dispVal = document.getElementById('disp-val');
            const feedback = document.getElementById('gen-feedback');

            if (renovatedCount < 3) {
                taxVal.innerText = "Low";
                dispVal.innerText = "Low";
                feedback.innerText = "Neighborhood is affordable but lacks city investment.";
            } else if (renovatedCount < 7) {
                taxVal.innerText = "Rising";
                dispVal.innerText = "Moderate";
                feedback.innerText = "Revitalization occurring. New businesses opening. Some rents increasing.";
            } else {
                taxVal.innerText = "High (Booming)";
                dispVal.innerText = "CRITICAL";
                feedback.innerHTML = "<strong>Full Gentrification.</strong> City services are excellent, but original residents have been priced out.";
                feedback.className = "p-4 bg-rose-50 rounded border border-rose-200 text-xs text-rose-800 font-bold";
            }
        }

        // --- 3. SQUATTER LOGIC ---
        function resolveSquatter(action) {
            const vis = document.getElementById('squatter-vis');
            const res = document.getElementById('squatter-res');
            const desc = document.getElementById('squatter-desc');

            if (action === 'evict') {
                vis.innerHTML = "üöúüèöÔ∏èüö´";
                res.innerText = "Status: Conflict & Homelessness";
                res.className = "text-sm font-bold text-red-400";
                desc.innerText = "You cleared the land, but the people just moved to another hillside. Social unrest increases.";
            } else {
                vis.innerHTML = "üè†üõ£Ô∏èüí°";
                res.innerText = "Status: In Situ Accretion";
                res.className = "text-sm font-bold text-emerald-400";
                desc.innerText = "With legal title, residents invested in their own homes. The government added electricity. It is now a working-class neighborhood.";
            }
        }

    </script>
</body>
</html>
