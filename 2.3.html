<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APHG Topic 2.3: Population Composition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Bar Animation */
        .pyr-bar { transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.3s; }
        
        /* Highlight classes for Dependency Ratio */
        .highlight-youth { background-color: #fcd34d !important; } /* Amber-300 */
        .highlight-elderly { background-color: #a5b4fc !important; } /* Indigo-300 */
        .dimmed { opacity: 0.3; }
        
        /* Card Hover */
        .scenario-btn {
            transition: all 0.2s;
        }
        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .scenario-btn.active {
            ring: 2px solid #4f46e5;
            background-color: #eef2ff;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-indigo-900 text-white p-6 shadow-lg shrink-0">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold">Topic 2.3: Population Composition</h1>
                <p class="text-indigo-200 text-sm mt-1">Age Structure, Sex Ratio, and Population Pyramids (PSO-2.F)</p>
            </div>
            <div class="hidden md:block text-xs bg-indigo-800 px-3 py-1 rounded border border-indigo-700">
                Predicting Markets & Needs
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-6xl mx-auto w-full p-6 space-y-8">

        <!-- SECTION 1: THE PYRAMID ANALYZER -->
        <div class="grid lg:grid-cols-3 gap-8">
            
            <!-- Left: Controls -->
            <section class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 space-y-6">
                <div>
                    <h2 class="text-lg font-bold text-slate-800 mb-3 uppercase tracking-wider">1. Select Profile</h2>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="loadData('rapid')" id="btn-rapid" class="scenario-btn active p-3 rounded-lg border border-slate-200 text-left">
                            <div class="text-2xl mb-1">üî∫</div>
                            <div class="font-bold text-sm text-slate-700">Rapid Growth</div>
                            <div class="text-[10px] text-slate-500">Stage 2 (e.g., Niger)</div>
                        </button>
                        <button onclick="loadData('slow')" id="btn-slow" class="scenario-btn p-3 rounded-lg border border-slate-200 text-left">
                            <div class="text-2xl mb-1">‚ñÆ</div>
                            <div class="font-bold text-sm text-slate-700">Stable Growth</div>
                            <div class="text-[10px] text-slate-500">Stage 4 (e.g., USA)</div>
                        </button>
                        <button onclick="loadData('negative')" id="btn-negative" class="scenario-btn p-3 rounded-lg border border-slate-200 text-left">
                            <div class="text-2xl mb-1">üîª</div>
                            <div class="font-bold text-sm text-slate-700">Negative Growth</div>
                            <div class="text-[10px] text-slate-500">Stage 5 (e.g., Japan)</div>
                        </button>
                        <button onclick="loadData('distorted')" id="btn-distorted" class="scenario-btn p-3 rounded-lg border border-slate-200 text-left">
                            <div class="text-2xl mb-1">‚ö°</div>
                            <div class="font-bold text-sm text-slate-700">Distorted</div>
                            <div class="text-[10px] text-slate-500">Migrant Labor (e.g., UAE)</div>
                        </button>
                    </div>
                </div>

                <div class="border-t border-slate-100 pt-4">
                    <h2 class="text-lg font-bold text-slate-800 mb-3 uppercase tracking-wider">2. Analysis Tools</h2>
                    <button onclick="toggleDependency()" id="btn-dep" class="w-full py-2 px-4 bg-white border-2 border-slate-300 text-slate-600 font-bold rounded-lg hover:bg-slate-50 transition flex items-center justify-center gap-2">
                        <span>üëÅÔ∏è</span> Show Dependency Ratio
                    </button>
                    <p class="text-xs text-slate-400 mt-2 text-center">Highlights Youth (0-14) and Elderly (65+) dependents.</p>
                </div>
            </section>

            <!-- Center: The Pyramid Visualization -->
            <section class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg border border-slate-200 flex flex-col">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="chart-title" class="text-xl font-extrabold text-indigo-900">Population Pyramid</h2>
                    <div class="flex gap-4 text-xs font-bold">
                        <div class="flex items-center"><span class="w-3 h-3 bg-blue-500 mr-1 rounded-sm"></span> Male</div>
                        <div class="flex items-center"><span class="w-3 h-3 bg-pink-500 mr-1 rounded-sm"></span> Female</div>
                    </div>
                </div>

                <!-- Pyramid Container -->
                <div class="relative flex-1 min-h-[400px] flex justify-center items-end pb-6">
                    
                    <!-- Y-Axis Labels (Age Cohorts) -->
                    <div class="absolute left-1/2 transform -translate-x-1/2 flex flex-col-reverse h-full justify-between text-[10px] text-slate-400 font-mono z-10 pointer-events-none">
                        <span class="h-[5%] flex items-center justify-center">0-4</span>
                        <span class="h-[5%] flex items-center justify-center">5-9</span>
                        <span class="h-[5%] flex items-center justify-center">10-14</span>
                        <span class="h-[5%] flex items-center justify-center">15-19</span>
                        <span class="h-[5%] flex items-center justify-center">20-24</span>
                        <span class="h-[5%] flex items-center justify-center">25-29</span>
                        <span class="h-[5%] flex items-center justify-center">30-34</span>
                        <span class="h-[5%] flex items-center justify-center">35-39</span>
                        <span class="h-[5%] flex items-center justify-center">40-44</span>
                        <span class="h-[5%] flex items-center justify-center">45-49</span>
                        <span class="h-[5%] flex items-center justify-center">50-54</span>
                        <span class="h-[5%] flex items-center justify-center">55-59</span>
                        <span class="h-[5%] flex items-center justify-center">60-64</span>
                        <span class="h-[5%] flex items-center justify-center">65-69</span>
                        <span class="h-[5%] flex items-center justify-center">70-74</span>
                        <span class="h-[5%] flex items-center justify-center">75-79</span>
                        <span class="h-[5%] flex items-center justify-center">80-84</span>
                        <span class="h-[5%] flex items-center justify-center">85+</span>
                    </div>

                    <!-- Bars Container -->
                    <div class="w-full h-full flex flex-col-reverse justify-between relative z-0" id="pyramid-bars">
                        <!-- Bars injected via JS -->
                    </div>
                    
                    <!-- Center Line -->
                    <div class="absolute left-1/2 h-full w-px bg-slate-300"></div>
                </div>
                
                <!-- X-Axis Labels -->
                <div class="flex justify-between px-10 text-xs text-slate-400 font-mono border-t border-slate-100 pt-2">
                    <span>10%</span><span>5%</span><span>0</span><span>5%</span><span>10%</span>
                </div>
            </section>
        </div>

        <!-- SECTION 2: MARKET & SERVICE PREDICTION (PSO-2.F.1) -->
        <section class="bg-indigo-50 rounded-xl border border-indigo-100 p-6 shadow-inner">
            <h2 class="text-lg font-bold text-indigo-900 mb-4 flex items-center">
                <span class="text-2xl mr-2">üîÆ</span> Future Needs Predictor
            </h2>
            <div class="grid md:grid-cols-3 gap-6">
                
                <!-- Prediction 1 -->
                <div class="bg-white p-4 rounded-lg shadow-sm">
                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-1">Goods & Services</h4>
                    <div id="pred-market" class="text-sm font-bold text-slate-800 leading-snug">
                        Invest in diapers and schools.
                    </div>
                </div>

                <!-- Prediction 2 -->
                <div class="bg-white p-4 rounded-lg shadow-sm">
                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-1">Social Challenge</h4>
                    <div id="pred-social" class="text-sm font-bold text-slate-800 leading-snug">
                        Providing enough jobs for the massive youth population entering the workforce.
                    </div>
                </div>

                <!-- Prediction 3 -->
                <div class="bg-white p-4 rounded-lg shadow-sm">
                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-1">Long-term Outlook</h4>
                    <div id="pred-future" class="text-sm font-bold text-slate-800 leading-snug">
                        Population will double in ~25 years (Doubling Time).
                    </div>
                </div>

            </div>
        </section>

    </main>

    <script>
        // --- DATA & LOGIC ---
        
        // Format: [Male %, Female %] for each cohort 0-4 up to 85+
        const profiles = {
            'rapid': {
                title: "Rapid Growth (The Triangle)",
                data: [
                    [9.0, 8.8], [8.5, 8.3], [7.8, 7.6], // 0-14 (Wide Base)
                    [6.5, 6.3], [5.5, 5.4], [4.5, 4.4], [3.8, 3.7], [3.0, 2.9], // Working
                    [2.5, 2.4], [2.0, 1.9], [1.5, 1.4], [1.2, 1.1], [0.9, 0.8],
                    [0.6, 0.5], [0.4, 0.3], [0.2, 0.2], [0.1, 0.1], [0.05, 0.05]  // 65+ (Narrow Top)
                ],
                market: "High demand for <strong>Pediatrics, Schools, and Daycare</strong>. Large market for youth culture products.",
                social: "High <strong>Youth Dependency Ratio</strong>. Strain on education system. Need to create entry-level jobs.",
                future: "Population Momentum ensures growth will continue for decades even if fertility drops."
            },
            'slow': {
                title: "Stable Growth (The Column)",
                data: [
                    [3.1, 3.0], [3.1, 3.0], [3.2, 3.1], // 0-14 (Even)
                    [3.3, 3.2], [3.4, 3.3], [3.5, 3.4], [3.4, 3.3], [3.3, 3.2],
                    [3.2, 3.1], [3.1, 3.0], [3.0, 2.9], [2.8, 2.7], [2.5, 2.6],
                    [2.0, 2.2], [1.5, 1.8], [1.0, 1.4], [0.5, 1.0], [0.3, 0.8]  // 65+ (Tapered but wider)
                ],
                market: "Steady demand for all sectors. Growing market for <strong>Financial Services and Healthcare</strong>.",
                social: "Balanced Dependency Ratio. Focus shifts to maintaining infrastructure and quality of life.",
                future: "Replacement level fertility (2.1). Population will remain constant."
            },
            'negative': {
                title: "Negative Growth (The Cup)",
                data: [
                    [2.0, 1.9], [2.1, 2.0], [2.2, 2.1], // 0-14 (Narrow Base)
                    [2.5, 2.4], [3.0, 2.9], [3.5, 3.4], [3.8, 3.7], [4.0, 3.9],
                    [4.2, 4.1], [4.0, 3.9], [3.5, 3.6], [3.0, 3.2], [2.8, 3.0],
                    [2.5, 2.8], [2.0, 2.5], [1.5, 2.0], [1.0, 1.5], [0.5, 1.0]  // 65+ (Wide Top)
                ],
                market: "Booming market for <strong>Gray Economy</strong> (Nursing homes, pharmaceuticals, travel for seniors).",
                social: "High <strong>Elderly Dependency Ratio</strong>. Labor shortages. Pressure on pension systems.",
                future: "Population decline. Potential need for pro-natalist policies or immigration."
            },
            'distorted': {
                title: "Distorted Sex Ratio (The Bulge)",
                data: [
                    [2.0, 1.9], [2.0, 1.9], [2.0, 1.9],
                    [2.5, 2.0], [5.0, 2.0], [8.0, 2.5], [9.0, 2.5], [8.5, 2.0], // Working Age Males Huge
                    [6.0, 1.5], [4.0, 1.5], [3.0, 1.5], [2.0, 1.5], [1.5, 1.5],
                    [1.0, 1.0], [0.5, 0.8], [0.3, 0.5], [0.2, 0.3], [0.1, 0.2]
                ],
                market: "High demand for <strong>Male-oriented goods</strong>, remittances, and temporary housing.",
                social: "Extreme Gender Imbalance. Cultural friction between migrant workers and locals.",
                future: "Population fluctuates wildly based on economic conditions and labor laws."
            }
        };

        let isDepShown = false;

        function loadData(type) {
            // 1. Update Active Button
            document.querySelectorAll('.scenario-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${type}`).classList.add('active');

            // 2. Get Data
            const profile = profiles[type];
            document.getElementById('chart-title').innerText = profile.title;
            document.getElementById('pred-market').innerHTML = profile.market;
            document.getElementById('pred-social').innerHTML = profile.social;
            document.getElementById('pred-future').innerHTML = profile.future;

            // 3. Render Bars
            const container = document.getElementById('pyramid-bars');
            container.innerHTML = ''; // Clear

            profile.data.forEach((row, index) => {
                const maleWidth = row[0] * 10; // Scale factor
                const femaleWidth = row[1] * 10;
                
                // Create row container
                // Use explicit height for children to avoid flex collapse
                const rowDiv = document.createElement('div');
                rowDiv.className = "flex w-full h-[5%]"; // Removed items-center to allow stretch
                
                // Male Bar (Right aligned in left half)
                const leftSide = document.createElement('div');
                leftSide.className = "w-1/2 h-full flex justify-end pr-1";
                const maleBar = document.createElement('div');
                maleBar.className = `h-full bg-blue-500 rounded-l-sm pyr-bar bar-row-${index}`;
                maleBar.style.width = `${maleWidth}%`;
                leftSide.appendChild(maleBar);

                // Female Bar (Left aligned in right half)
                const rightSide = document.createElement('div');
                rightSide.className = "w-1/2 h-full flex justify-start pl-1";
                const femaleBar = document.createElement('div');
                femaleBar.className = `h-full bg-pink-500 rounded-r-sm pyr-bar bar-row-${index}`;
                femaleBar.style.width = `${femaleWidth}%`;
                rightSide.appendChild(femaleBar);

                rowDiv.appendChild(leftSide);
                rowDiv.appendChild(rightSide);
                container.appendChild(rowDiv);
            });

            // Re-apply dependency highlight if active
            if(isDepShown) applyHighlight(true);
        }

        function toggleDependency() {
            isDepShown = !isDepShown;
            applyHighlight(isDepShown);
            
            const btn = document.getElementById('btn-dep');
            if (isDepShown) {
                btn.classList.add('bg-indigo-50', 'border-indigo-300', 'text-indigo-700');
                btn.innerHTML = "<span>üëÅÔ∏è</span> Hide Dependency Ratio";
            } else {
                btn.classList.remove('bg-indigo-50', 'border-indigo-300', 'text-indigo-700');
                btn.innerHTML = "<span>üëÅÔ∏è</span> Show Dependency Ratio";
            }
        }

        function applyHighlight(show) {
            // Indices 0-2 are ages 0-14 (Youth)
            // Indices 13-17 are ages 65+ (Elderly)
            // Indices 3-12 are Working Age
            
            for(let i=0; i<18; i++) {
                const bars = document.querySelectorAll(`.bar-row-${i}`);
                bars.forEach(bar => {
                    // Reset first
                    bar.classList.remove('highlight-youth', 'highlight-elderly', 'dimmed');
                    
                    if (show) {
                        if (i <= 2) {
                            bar.classList.add('highlight-youth');
                        } else if (i >= 13) {
                            bar.classList.add('highlight-elderly');
                        } else {
                            bar.classList.add('dimmed');
                        }
                    }
                });
            }
        }

        // Init
        loadData('rapid');

    </script>
</body>
</html>
