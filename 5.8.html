<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APHG Topic 5.8: The Von Th√ºnen Model</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Smooth Drawing */
        path { transition: d 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), fill 0.5s ease; }
        
        /* Draggable Items */
        .draggable { cursor: grab; }
        .draggable:active { cursor: grabbing; }
        
        /* Drop Zone Highlight */
        .drop-zone { transition: all 0.3s; }
        .drop-zone.highlight { background-color: #f0fdf4; border-color: #22c55e; }
        
        /* Animation for River Effect */
        .river-flow {
            stroke-dasharray: 10;
            animation: flow 2s linear infinite;
        }
        @keyframes flow { to { stroke-dashoffset: -20; } }

        /* Scenario Btn */
        .scen-btn { transition: all 0.2s; }
        .scen-btn.active { background-color: #1e293b; color: white; border-color: #1e293b; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-cyan-800 text-white p-6 shadow-lg shrink-0 z-10">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold">Topic 5.8: The Von Th√ºnen Model</h1>
                <p class="text-cyan-200 text-sm mt-1">Theory, Application, and Reality Checks (PSO-5.E)</p>
            </div>
            <div class="hidden md:block text-xs bg-cyan-700 px-3 py-1 rounded border border-cyan-600">
                1826: The Isolated State
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-6xl mx-auto w-full p-6 space-y-10">

        <!-- SECTION 1: BUILD THE MODEL (Logic Check) -->
        <section class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="p-6 border-b border-slate-100 bg-cyan-50 flex justify-between items-center">
                <div>
                    <h2 class="text-xl font-bold text-cyan-900">1. Constructing the Model</h2>
                    <p class="text-sm text-slate-600 mt-1">Drag the land use to its correct distance from the market based on <strong>Transport Cost</strong> and <strong>Perishability</strong>.</p>
                </div>
                <button onclick="checkOrder()" class="bg-cyan-600 hover:bg-cyan-500 text-white px-4 py-2 rounded font-bold text-sm shadow transition">
                    Check Order
                </button>
            </div>

            <div class="grid md:grid-cols-4 gap-4 p-6 bg-slate-100">
                
                <!-- Bank -->
                <div class="md:col-span-1 space-y-3">
                    <h3 class="text-xs font-bold text-slate-400 uppercase">Land Uses (Drag Me)</h3>
                    <div id="item-forest" class="draggable bg-emerald-600 text-white p-3 rounded shadow cursor-grab" draggable="true" ondragstart="drag(event)" data-id="forest">
                        <strong>üå≤ Timber</strong><br><span class="text-[10px] opacity-80">Heavy & Hard to Transport</span>
                    </div>
                    <div id="item-dairy" class="draggable bg-white text-slate-800 border border-slate-300 p-3 rounded shadow cursor-grab" draggable="true" ondragstart="drag(event)" data-id="dairy">
                        <strong>ü•õ Dairy/Gardening</strong><br><span class="text-[10px] opacity-80">Perishable & Intensive</span>
                    </div>
                    <div id="item-livestock" class="draggable bg-red-500 text-white p-3 rounded shadow cursor-grab" draggable="true" ondragstart="drag(event)" data-id="livestock">
                        <strong>üêÑ Livestock</strong><br><span class="text-[10px] opacity-80">Animals walk to market</span>
                    </div>
                    <div id="item-grain" class="draggable bg-yellow-400 text-yellow-900 p-3 rounded shadow cursor-grab" draggable="true" ondragstart="drag(event)" data-id="grain">
                        <strong>üåæ Grains</strong><br><span class="text-[10px] opacity-80">Light & Non-Perishable</span>
                    </div>
                </div>

                <!-- The Rings (Drop Zones) -->
                <div class="md:col-span-3 flex items-center justify-start relative h-48 bg-slate-200 rounded-xl border-2 border-slate-300 overflow-hidden">
                    
                    <!-- City -->
                    <div class="absolute left-0 h-full w-16 bg-slate-800 flex items-center justify-center text-white font-bold text-xs z-20">
                        <div class="transform -rotate-90">MARKET</div>
                    </div>

                    <!-- Zone 1 -->
                    <div id="zone-1" class="drop-zone w-1/4 h-full border-r border-white/50 flex items-center justify-center text-xs font-bold text-slate-400" ondragover="allowDrop(event)" ondrop="drop(event)">
                        Ring 1
                    </div>
                    <!-- Zone 2 -->
                    <div id="zone-2" class="drop-zone w-1/4 h-full border-r border-white/50 flex items-center justify-center text-xs font-bold text-slate-400" ondragover="allowDrop(event)" ondrop="drop(event)">
                        Ring 2
                    </div>
                    <!-- Zone 3 -->
                    <div id="zone-3" class="drop-zone w-1/4 h-full border-r border-white/50 flex items-center justify-center text-xs font-bold text-slate-400" ondragover="allowDrop(event)" ondrop="drop(event)">
                        Ring 3
                    </div>
                    <!-- Zone 4 -->
                    <div id="zone-4" class="drop-zone w-1/4 h-full flex items-center justify-center text-xs font-bold text-slate-400" ondragover="allowDrop(event)" ondrop="drop(event)">
                        Ring 4
                    </div>

                </div>
            </div>
            <div id="order-feedback" class="text-center text-sm font-bold py-2 hidden"></div>
        </section>

        <!-- SECTION 2: DISTORTING THE MODEL (Scenarios) -->
        <section class="grid lg:grid-cols-3 gap-8">
            
            <!-- Controls -->
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 flex flex-col gap-4">
                <h2 class="text-xl font-bold text-slate-800 mb-2">2. Distorting Reality</h2>
                <p class="text-sm text-slate-500 mb-4">The "Isotropic Plain" (flat, featureless land) rarely exists. See how geography changes the rings.</p>

                <button onclick="setScenario('classic')" id="btn-classic" class="scen-btn active w-full text-left p-4 rounded-lg border border-slate-200 hover:bg-slate-50 font-bold text-slate-700">
                    Classic Model
                </button>
                <button onclick="setScenario('river')" id="btn-river" class="scen-btn w-full text-left p-4 rounded-lg border border-slate-200 hover:bg-slate-50 font-bold text-slate-700">
                    Add River (Transport)
                </button>
                <button onclick="setScenario('forest')" id="btn-forest" class="scen-btn w-full text-left p-4 rounded-lg border border-slate-200 hover:bg-slate-50 font-bold text-slate-700">
                    Modern (No Forest)
                </button>
                
                <div id="scen-desc" class="mt-auto p-3 bg-slate-100 rounded text-xs text-slate-600 italic border-l-4 border-cyan-500">
                    The original model assumes ox-carts and no rivers.
                </div>
            </div>

            <!-- Visualizer -->
            <div class="lg:col-span-2 relative h-[400px] bg-slate-900 rounded-xl shadow-lg overflow-hidden flex items-center justify-center">
                
                <svg id="model-svg" viewBox="0 0 500 500" class="w-full h-full">
                    <!-- Base -->
                    <rect width="500" height="500" fill="#1e293b" />
                    
                    <!-- Rings (Paths defined in JS) -->
                    <!-- Zone 4: Livestock (Red) -->
                    <path id="path-4" d="M 250 250 m -200 0 a 200 200 0 1 0 400 0 a 200 200 0 1 0 -400 0" fill="#ef4444" opacity="0.8" />
                    
                    <!-- Zone 3: Grains (Yellow) -->
                    <path id="path-3" d="M 250 250 m -140 0 a 140 140 0 1 0 280 0 a 140 140 0 1 0 -280 0" fill="#facc15" opacity="0.9" />

                    <!-- Zone 2: Forest (Green) -->
                    <path id="path-2" d="M 250 250 m -90 0 a 90 90 0 1 0 180 0 a 90 90 0 1 0 -180 0" fill="#15803d" />

                    <!-- Zone 1: Dairy (White/Light Green) -->
                    <path id="path-1" d="M 250 250 m -50 0 a 50 50 0 1 0 100 0 a 50 50 0 1 0 -100 0" fill="#dcfce7" />

                    <!-- River (Hidden by default) -->
                    <path id="river" d="M 250 250 L 250 0" stroke="#3b82f6" stroke-width="0" fill="none" />

                    <!-- City -->
                    <circle cx="250" cy="250" r="15" fill="#1e293b" stroke="white" stroke-width="3" />
                </svg>

            </div>
        </section>

        <!-- SECTION 3: NATIONAL SCALE APPLICATION -->
        <section class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 p-8 text-white">
            <div class="flex flex-col md:flex-row gap-8 items-center">
                <div class="flex-1">
                    <h2 class="text-xl font-bold text-white mb-4">3. Scaling Up: The USA</h2>
                    <p class="text-sm text-slate-300 leading-relaxed mb-4">
                        Geographers apply Von Th√ºnen to the entire United States. 
                        <br><br>
                        If <strong>New York City</strong> is the "Market", the rings expand westward across the continent.
                    </p>
                    <ul class="text-xs text-slate-400 space-y-2 list-disc pl-4">
                        <li><strong>Northeast:</strong> Dairy/Vegetables (NJ = "Garden State").</li>
                        <li><strong>Midwest:</strong> Grains (Corn/Soy).</li>
                        <li><strong>West:</strong> Livestock Ranching (Cattle).</li>
                        <li class="text-cyan-400 font-bold">Exception: California/Florida (Specialty Crops due to climate).</li>
                    </ul>
                </div>
                
                <!-- Abstract Map Visual -->
                <div class="w-64 h-40 relative bg-slate-700 rounded-lg overflow-hidden border-2 border-slate-500">
                    <!-- US Shape approximation -->
                    <div class="absolute inset-0 flex">
                        <div class="w-1/3 h-full bg-red-500/50 flex items-center justify-center text-[10px] font-bold">Ranching</div>
                        <div class="w-1/3 h-full bg-yellow-500/50 flex items-center justify-center text-[10px] font-bold">Grains</div>
                        <div class="w-1/3 h-full bg-emerald-500/50 flex items-center justify-center text-[10px] font-bold text-center">Dairy<br>Market</div>
                    </div>
                    <div class="absolute top-10 right-4 w-3 h-3 bg-white rounded-full shadow"></div>
                    <div class="absolute top-12 right-8 text-[8px] font-bold">NYC</div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- 1. DRAG & DROP LOGIC ---
        function allowDrop(ev) { ev.preventDefault(); }
        
        function drag(ev) {
            ev.dataTransfer.setData("id", ev.target.id);
            ev.dataTransfer.setData("type", ev.target.dataset.id);
        }

        function drop(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("id");
            // Append to drop zone, clearing existing
            ev.target.innerHTML = ""; 
            ev.target.appendChild(document.getElementById(data));
        }

        function checkOrder() {
            // Correct: Dairy (1), Forest (2), Grain (3), Livestock (4)
            const z1 = document.getElementById('zone-1').querySelector('div')?.dataset.id;
            const z2 = document.getElementById('zone-2').querySelector('div')?.dataset.id;
            const z3 = document.getElementById('zone-3').querySelector('div')?.dataset.id;
            const z4 = document.getElementById('zone-4').querySelector('div')?.dataset.id;
            
            const fb = document.getElementById('order-feedback');
            
            if (z1 === 'dairy' && z2 === 'forest' && z3 === 'grain' && z4 === 'livestock') {
                fb.innerText = "Perfect! You understand Perishability and Transport Cost.";
                fb.className = "text-center text-sm font-bold py-2 text-emerald-600 bg-emerald-50 rounded";
            } else {
                fb.innerText = "Incorrect. Remember: Heavy/Perishable items must be closest.";
                fb.className = "text-center text-sm font-bold py-2 text-red-600 bg-red-50 rounded";
            }
            fb.classList.remove('hidden');
        }


        // --- 2. SCENARIO LOGIC ---
        function setScenario(type) {
            // Buttons
            document.querySelectorAll('.scen-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${type}`).classList.add('active');

            const desc = document.getElementById('scen-desc');
            const river = document.getElementById('river');
            const p1 = document.getElementById('path-1'); // Dairy
            const p2 = document.getElementById('path-2'); // Forest
            const p3 = document.getElementById('path-3'); // Grain
            const p4 = document.getElementById('path-4'); // Livestock

            if (type === 'classic') {
                desc.innerText = "Classic Model: Concentric rings based solely on distance from the single market.";
                river.setAttribute("stroke-width", "0");
                // Standard Rings
                p4.setAttribute("d", "M 250 250 m -200 0 a 200 200 0 1 0 400 0 a 200 200 0 1 0 -400 0");
                p3.setAttribute("d", "M 250 250 m -140 0 a 140 140 0 1 0 280 0 a 140 140 0 1 0 -280 0");
                p2.setAttribute("d", "M 250 250 m -90 0 a 90 90 0 1 0 180 0 a 90 90 0 1 0 -180 0");
                p1.setAttribute("d", "M 250 250 m -50 0 a 50 50 0 1 0 100 0 a 50 50 0 1 0 -100 0");
                
                p2.setAttribute("opacity", "1"); // Show Forest
            } 
            else if (type === 'river') {
                desc.innerText = "River Effect: Transport is cheaper by boat. Rings stretch along the river because 'Effective Distance' is shorter.";
                river.setAttribute("stroke-width", "15");
                river.setAttribute("class", "river-flow");
                
                // Stretched Rings (Elongated upward along Y axis)
                p4.setAttribute("d", "M 250 250 m -200 0 c 0 -300, 400 -300, 400 0 a 200 200 0 1 1 -400 0"); // Rough stretch shape
                p3.setAttribute("d", "M 250 250 m -140 0 c 0 -220, 280 -220, 280 0 a 140 140 0 1 1 -280 0");
                p2.setAttribute("d", "M 250 250 m -90 0 c 0 -150, 180 -150, 180 0 a 90 90 0 1 1 -180 0");
                p1.setAttribute("d", "M 250 250 m -50 0 c 0 -100, 100 -100, 100 0 a 50 50 0 1 1 -100 0");

                p2.setAttribute("opacity", "1");
            }
            else if (type === 'forest') {
                desc.innerText = "Modern World: Refrigeration expands Dairy. Lumber is now imported or substituted, so the Forest ring disappears.";
                river.setAttribute("stroke-width", "0");
                
                // Forest Gone (Scale 0), Dairy Expanded
                p4.setAttribute("d", "M 250 250 m -200 0 a 200 200 0 1 0 400 0 a 200 200 0 1 0 -400 0"); // Livestock same
                p3.setAttribute("d", "M 250 250 m -160 0 a 160 160 0 1 0 320 0 a 160 160 0 1 0 -320 0"); // Grain bigger
                p2.setAttribute("d", "M 250 250 m -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0"); // Tiny/Gone
                p2.setAttribute("opacity", "0");
                p1.setAttribute("d", "M 250 250 m -100 0 a 100 100 0 1 0 200 0 a 100 100 0 1 0 -200 0"); // Dairy Huge
            }
        }

    </script>
</body>
</html>
