<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APHG Topic 5.2: Settlement Patterns & Survey Methods</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Survey Lines Animation */
        .survey-line {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: draw 2s forwards;
        }
        @keyframes draw { to { stroke-dashoffset: 0; } }
        
        /* House Animation */
        .house { transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        
        /* Card Hover */
        .pattern-btn {
            transition: all 0.2s;
        }
        .pattern-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .pattern-btn.active {
            ring-width: 2px;
            ring-offset-width: 2px;
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-amber-900 text-white p-6 shadow-lg shrink-0 z-10">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold">Topic 5.2: Settlement & Survey</h1>
                <p class="text-amber-200 text-sm mt-1">How we divide land and where we build homes (PSO-5.B)</p>
            </div>
            <div class="hidden md:block text-xs bg-amber-800 px-3 py-1 rounded border border-amber-700">
                Metes & Bounds ‚Ä¢ Township & Range ‚Ä¢ Long Lot
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-6xl mx-auto w-full p-6 space-y-10">

        <!-- SECTION 1: RURAL SURVEY METHODS (Dividing the Land) -->
        <section class="bg-white rounded-2xl shadow-xl overflow-hidden border border-stone-200">
            <div class="p-6 border-b border-stone-100 bg-orange-50 flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h2 class="text-xl font-bold text-orange-900">1. Survey Methods (PSO-5.B.3)</h2>
                    <p class="text-sm text-stone-600 mt-1">Select a system to see how it divides the landscape.</p>
                </div>
                
                <!-- Controls -->
                <div class="flex gap-2 bg-white p-1 rounded-lg shadow-sm border border-stone-200">
                    <button onclick="setSurvey('metes')" id="btn-metes" class="pattern-btn active px-4 py-2 text-xs font-bold rounded transition bg-stone-800 text-white border border-stone-800">Metes & Bounds</button>
                    <button onclick="setSurvey('township')" id="btn-township" class="pattern-btn px-4 py-2 text-xs font-bold rounded transition bg-white text-stone-600 border border-stone-200">Township & Range</button>
                    <button onclick="setSurvey('longlot')" id="btn-longlot" class="pattern-btn px-4 py-2 text-xs font-bold rounded transition bg-white text-stone-600 border border-stone-200">Long Lot</button>
                </div>
            </div>

            <div class="grid md:grid-cols-3 h-[400px]">
                
                <!-- Visualizer -->
                <div class="md:col-span-2 relative bg-stone-200 overflow-hidden flex items-center justify-center">
                    
                    <svg id="survey-svg" viewBox="0 0 600 400" class="w-full h-full bg-[#d6d3d1]">
                        <!-- Landscape Features (Constant) -->
                        
                        <!-- River (for Long Lot) -->
                        <path id="feature-river" d="M 0 350 Q 300 300 600 350 L 600 400 L 0 400 Z" fill="#3b82f6" class="transition-opacity duration-500" />
                        
                        <!-- Trees/Rocks (for Metes & Bounds) -->
                        <g id="feature-nature" class="transition-opacity duration-500">
                            <text x="100" y="100" font-size="30">üå≥</text>
                            <text x="400" y="80" font-size="30">ü™®</text>
                            <text x="500" y="300" font-size="30">üå≥</text>
                            <text x="150" y="320" font-size="30">üèûÔ∏è</text>
                            <text x="300" y="200" font-size="30">üå≥</text>
                        </g>

                        <!-- Grid Base (for Township) - invisible initially -->
                        <rect id="feature-grid-base" width="600" height="400" fill="#f5f5f4" opacity="0" class="transition-opacity duration-500"/>

                        <!-- Dynamic Lines Layer -->
                        <g id="survey-lines"></g>
                        
                        <!-- Labels -->
                        <text id="survey-label" x="300" y="50" text-anchor="middle" font-weight="bold" font-size="16" fill="#44403c" opacity="0.8">Select a Method</text>
                    </svg>

                </div>

                <!-- Info Panel -->
                <div class="p-6 bg-stone-50 border-l border-stone-200 flex flex-col justify-center">
                    <div id="survey-info">
                        <h3 class="text-xl font-bold text-stone-800 mb-2">Metes and Bounds</h3>
                        <div class="text-[10px] font-bold uppercase tracking-wider text-orange-600 mb-4 bg-orange-100 inline-block px-2 py-1 rounded">Origin: Great Britain</div>
                        <p class="text-sm text-stone-600 leading-relaxed mb-4">
                            Uses physical features of the local geography (trees, rocks, streams) to define boundaries.
                        </p>
                        <ul class="text-xs text-stone-500 space-y-2 list-disc pl-4">
                            <li><strong>Shape:</strong> Irregular, jigsaw puzzle-like.</li>
                            <li><strong>Where:</strong> Original 13 Colonies (East Coast USA).</li>
                            <li><strong>Cons:</strong> Features move (trees die, streams shift), causing disputes.</li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <!-- SECTION 2: SETTLEMENT PATTERNS (Where we live) -->
        <section class="bg-white rounded-2xl shadow-xl border border-stone-200 p-8">
            <div class="mb-6 flex justify-between items-end">
                <div>
                    <h2 class="text-xl font-bold text-stone-800">2. Settlement Patterns (PSO-5.B.2)</h2>
                    <p class="text-sm text-stone-500">How houses are arranged in rural areas.</p>
                </div>
                <div class="flex bg-stone-100 p-1 rounded-lg">
                    <button onclick="setPattern('clustered')" class="px-4 py-2 text-xs font-bold rounded hover:bg-white hover:shadow transition text-stone-700">Clustered</button>
                    <button onclick="setPattern('dispersed')" class="px-4 py-2 text-xs font-bold rounded hover:bg-white hover:shadow transition text-stone-700">Dispersed</button>
                    <button onclick="setPattern('linear')" class="px-4 py-2 text-xs font-bold rounded hover:bg-white hover:shadow transition text-stone-700">Linear</button>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8 items-center">
                <!-- Visualizer -->
                <div class="relative h-64 bg-emerald-100 rounded-xl border-4 border-stone-300 overflow-hidden shadow-inner">
                    
                    <!-- Road (for Linear) -->
                    <div id="road" class="absolute top-1/2 left-0 w-full h-8 bg-stone-400 border-y-2 border-stone-500 transform -translate-y-1/2 transition-opacity duration-500 opacity-0"></div>
                    
                    <!-- Center Point (Church/Market for Clustered) -->
                    <div id="center-point" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-4xl transition-opacity duration-500 opacity-0 z-10">‚õ™</div>

                    <!-- Houses Container -->
                    <div id="house-container" class="relative w-full h-full z-20">
                        <!-- Houses injected via JS -->
                    </div>
                </div>

                <!-- Explanation -->
                <div id="pattern-desc" class="bg-stone-50 p-6 rounded-xl border border-stone-200">
                    <h3 class="font-bold text-lg text-stone-800 mb-2">Clustered (Nucleated)</h3>
                    <p class="text-sm text-stone-600 mb-3">Houses are grouped closely together, often around a central feature like a church, pub, or village green.</p>
                    <div class="text-xs text-stone-500 space-y-1">
                        <p><strong>Why?</strong> Defense, shared resources, strong community.</p>
                        <p><strong>Where?</strong> Europe, Sub-Saharan Africa, Colonial New England.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- 1. SURVEY LOGIC ---
        const surveyTypes = {
            'metes': {
                title: "Metes and Bounds",
                origin: "Great Britain",
                desc: "Uses physical features (trees, rocks) to define boundaries. Shapes are irregular.",
                where: "US East Coast (13 Colonies)",
                draw: (svg) => {
                    // Draw irregular lines connecting features
                    // Tree (100,100) -> Rock (400,80) -> Tree (300,200) -> Creek (150,320) -> Start
                    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    path.setAttribute("d", "M 110 110 L 400 90 L 310 210 L 160 330 L 110 110");
                    path.setAttribute("fill", "rgba(255,255,255,0.3)");
                    path.setAttribute("stroke", "#dc2626"); // Red
                    path.setAttribute("stroke-width", "3");
                    path.setAttribute("stroke-dasharray", "10,5");
                    path.setAttribute("class", "survey-line");
                    svg.appendChild(path);
                },
                features: { river: 0, nature: 1, grid: 0 }
            },
            'township': {
                title: "Township and Range",
                origin: "US Land Ordinance (1785)",
                desc: "Rigid grid system based on latitude/longitude. Creates square plots (1 mile sections).",
                where: "US Midwest & West",
                draw: (svg) => {
                    // Draw Grid
                    for(let i=0; i<=600; i+=100) {
                        const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                        line.setAttribute("x1", i); line.setAttribute("y1", 0);
                        line.setAttribute("x2", i); line.setAttribute("y2", 400);
                        line.setAttribute("stroke", "#2563eb");
                        line.setAttribute("stroke-width", "2");
                        line.setAttribute("class", "survey-line");
                        svg.appendChild(line);
                    }
                    for(let i=0; i<=400; i+=100) {
                        const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                        line.setAttribute("x1", 0); line.setAttribute("y1", i);
                        line.setAttribute("x2", 600); line.setAttribute("y2", i);
                        line.setAttribute("stroke", "#2563eb");
                        line.setAttribute("stroke-width", "2");
                        line.setAttribute("class", "survey-line");
                        svg.appendChild(line);
                    }
                },
                features: { river: 0, nature: 0, grid: 1 }
            },
            'longlot': {
                title: "Long Lot System",
                origin: "France",
                desc: "Narrow strips of land extending back from a river or road so everyone gets access to transportation/water.",
                where: "Quebec, Louisiana, Texas",
                draw: (svg) => {
                    // Draw strips perpendicular to river (bottom)
                    for(let i=50; i<600; i+=50) {
                        const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                        line.setAttribute("x1", i); line.setAttribute("y1", 350); // River edge
                        line.setAttribute("x2", i); line.setAttribute("y2", 50); // Back of lot
                        line.setAttribute("stroke", "#ea580c"); // Orange
                        line.setAttribute("stroke-width", "2");
                        line.setAttribute("class", "survey-line");
                        svg.appendChild(line);
                        
                        // House near river
                        const house = document.createElementNS("http://www.w3.org/2000/svg", "text");
                        house.setAttribute("x", i - 10);
                        house.setAttribute("y", 330);
                        house.setAttribute("font-size", "20");
                        house.textContent = "üè†";
                        svg.appendChild(house);
                    }
                },
                features: { river: 1, nature: 0, grid: 0 }
            }
        };

        function setSurvey(type) {
            // Buttons
            document.querySelectorAll('.pattern-btn').forEach(b => {
                b.className = "pattern-btn px-4 py-2 text-xs font-bold rounded transition bg-white text-stone-600 border border-stone-200";
            });
            document.getElementById(`btn-${type}`).className = "pattern-btn active px-4 py-2 text-xs font-bold rounded transition bg-stone-800 text-white border border-stone-800";

            const info = surveyTypes[type];
            const svg = document.getElementById('survey-svg');
            const linesLayer = document.getElementById('survey-lines');
            
            // Features Toggle
            document.getElementById('feature-river').style.opacity = info.features.river;
            document.getElementById('feature-nature').style.opacity = info.features.nature;
            document.getElementById('feature-grid-base').style.opacity = info.features.grid;

            // Text Update
            document.getElementById('survey-label').textContent = info.title;
            const infoHTML = `
                <h3 class="text-xl font-bold text-stone-800 mb-2">${info.title}</h3>
                <div class="text-[10px] font-bold uppercase tracking-wider text-orange-600 mb-4 bg-orange-100 inline-block px-2 py-1 rounded">Origin: ${info.origin}</div>
                <p class="text-sm text-stone-600 leading-relaxed mb-4">${info.desc}</p>
                <ul class="text-xs text-stone-500 space-y-2 list-disc pl-4">
                    <li><strong>Key Feature:</strong> ${type === 'metes' ? 'Irregular shapes' : (type === 'township' ? 'Geometric Grid' : 'Narrow Strips')}</li>
                    <li><strong>Where:</strong> ${info.where}</li>
                </ul>
            `;
            document.getElementById('survey-info').innerHTML = infoHTML;

            // Draw
            linesLayer.innerHTML = '';
            info.draw(linesLayer);
        }


        // --- 2. SETTLEMENT LOGIC ---
        let houses = [];
        // Init houses array
        for(let i=0; i<15; i++) {
            const h = document.createElement('div');
            h.className = "house absolute text-2xl";
            h.innerText = "üè†";
            document.getElementById('house-container').appendChild(h);
            houses.push(h);
        }

        const patterns = {
            'clustered': {
                title: "Clustered (Nucleated)",
                desc: "Houses are grouped closely together, often around a central feature like a church, pub, or village green.",
                why: "Defense, shared resources, strong community.",
                where: "Europe, Sub-Saharan Africa, Colonial New England.",
                layout: (h) => {
                    // Circle center
                    const angle = Math.random() * Math.PI * 2;
                    const radius = Math.random() * 60 + 30; // Close to center
                    h.style.left = `calc(50% + ${Math.cos(angle) * radius}px)`;
                    h.style.top = `calc(50% + ${Math.sin(angle) * radius}px)`;
                },
                showRoad: 0, showCenter: 1
            },
            'dispersed': {
                title: "Dispersed",
                desc: "Houses are scattered far apart from each other. Typical of agricultural regions with large individual farms.",
                why: "Large machinery needs space. Independence. Availability of land.",
                where: "US Midwest (Township & Range), Canada, Australia.",
                layout: (h) => {
                    // Random spread
                    h.style.left = `${Math.random() * 90 + 5}%`;
                    h.style.top = `${Math.random() * 80 + 10}%`;
                },
                showRoad: 0, showCenter: 0
            },
            'linear': {
                title: "Linear",
                desc: "Buildings are arranged in a line, typically following a road, river, or dike.",
                why: "Access to transportation (Road/River) for everyone.",
                where: "French Canada (Quebec), along major highways.",
                layout: (h) => {
                    // Along horizontal line
                    const x = Math.random() * 90 + 5;
                    const yOffset = (Math.random() - 0.5) * 40; // Slight variance from road
                    h.style.left = `${x}%`;
                    h.style.top = `calc(50% + ${yOffset}px)`;
                },
                showRoad: 1, showCenter: 0
            }
        };

        function setPattern(type) {
            const data = patterns[type];
            
            // Update Visuals
            document.getElementById('road').style.opacity = data.showRoad;
            document.getElementById('center-point').style.opacity = data.showCenter;

            houses.forEach(h => data.layout(h));

            // Update Text
            document.getElementById('pattern-desc').innerHTML = `
                <h3 class="font-bold text-lg text-stone-800 mb-2">${data.title}</h3>
                <p class="text-sm text-stone-600 mb-3">${data.desc}</p>
                <div class="text-xs text-stone-500 space-y-1">
                    <p><strong>Why?</strong> ${data.why}</p>
                    <p><strong>Where?</strong> ${data.where}</p>
                </div>
            `;
        }

        // Init
        setSurvey('metes');
        setPattern('clustered');

    </script>
</body>
</html>
